{
  "_schema_info": {
    "version": "1.0",
    "description": "Configuration schema with metadata, widget types, and validation rules"
  },
  "app": {
    "ui": {
      "profile": {
        "description": "UI layout profile - auto detects screen size/DPI, compact for small screens, normal for large screens, hidpi for high resolution displays (4K, Retina)",
        "widget_type": "combobox",
        "data_type": "string",
        "validation": {
          "required": true,
          "allowed_values": ["auto", "compact", "normal", "hidpi"]
        },
        "default": "auto",
        "user_friendly_label": "UI Profile"
      },
      "theme": {
        "active": {
          "description": "Color theme - auto follows QGIS theme, or force specific theme (default, dark, light)",
          "widget_type": "combobox",
          "data_type": "string",
          "validation": {
            "required": true,
            "allowed_values": ["auto", "default", "dark", "light"]
          },
          "default": "auto",
          "user_friendly_label": "Active Theme"
        },
        "source": {
          "description": "Theme source - config uses config.json, qgis follows QGIS settings, system follows OS",
          "widget_type": "combobox",
          "data_type": "string",
          "validation": {
            "required": true,
            "allowed_values": ["config", "qgis", "system"]
          },
          "default": "config",
          "user_friendly_label": "Theme Source"
        }
      },
      "action_bar": {
        "position": {
          "description": "Position of action bar in the interface",
          "widget_type": "combobox",
          "data_type": "string",
          "validation": {
            "required": true,
            "allowed_values": ["top", "bottom", "left", "right"]
          },
          "default": "left",
          "user_friendly_label": "Action Bar Position"
        },
        "vertical_alignment": {
          "description": "Vertical alignment when action bar is positioned left or right",
          "widget_type": "combobox",
          "data_type": "string",
          "validation": {
            "required": true,
            "allowed_values": ["top", "bottom"]
          },
          "default": "top",
          "user_friendly_label": "Vertical Alignment"
        }
      },
      "feedback": {
        "level": {
          "description": "Amount of user feedback - minimal shows only errors, normal shows important messages, verbose shows all including debug",
          "widget_type": "combobox",
          "data_type": "string",
          "validation": {
            "required": true,
            "allowed_values": ["minimal", "normal", "verbose"]
          },
          "default": "normal",
          "user_friendly_label": "Feedback Level",
          "categories_affected": [
            "filter_count",
            "undo_redo",
            "backend_info",
            "config_changes",
            "progress_info",
            "history_status"
          ]
        }
      },
      "language": {
        "description": "Interface language - auto uses QGIS locale, or force specific language",
        "widget_type": "combobox",
        "data_type": "string",
        "validation": {
          "required": true,
          "allowed_values": [
            "auto",
            "en",
            "fr",
            "de",
            "es",
            "it",
            "nl",
            "pt",
            "pl",
            "zh",
            "ru",
            "id",
            "vi",
            "tr",
            "hi",
            "fi",
            "da",
            "sv",
            "nb"
          ]
        },
        "default": "auto",
        "user_friendly_label": "Language"
      }
    },
    "auto_activate": {
      "description": "Automatically open FilterMate when loading a project with vector layers",
      "widget_type": "checkbox",
      "data_type": "boolean",
      "validation": {
        "required": true
      },
      "default": false,
      "user_friendly_label": "Auto-activate Plugin"
    },
    "buttons": {
      "style": {
        "border_radius": {
          "description": "CSS border radius for buttons (e.g., '10px', '5px')",
          "widget_type": "textbox",
          "data_type": "string",
          "validation": {
            "required": true,
            "pattern": "^\\d+px$"
          },
          "default": "10px",
          "user_friendly_label": "Button Border Radius"
        },
        "padding": {
          "description": "CSS padding for buttons (e.g., '10px 10px 10px 10px')",
          "widget_type": "textbox",
          "data_type": "string",
          "validation": {
            "required": true,
            "pattern": "^\\d+px \\d+px \\d+px \\d+px$"
          },
          "default": "10px 10px 10px 10px",
          "user_friendly_label": "Button Padding"
        },
        "background_color": {
          "description": "Background color for buttons (hex color code)",
          "widget_type": "colorpicker",
          "data_type": "string",
          "validation": {
            "required": true,
            "pattern": "^#[0-9A-Fa-f]{6}$"
          },
          "default": "#F0F0F0",
          "user_friendly_label": "Button Background Color"
        }
      },
      "icon_sizes": {
        "action": {
          "description": "Icon size in pixels for action buttons (filter, undo, redo, etc.)",
          "widget_type": "spinbox",
          "data_type": "integer",
          "validation": {
            "required": true,
            "min": 16,
            "max": 64
          },
          "default": 25,
          "user_friendly_label": "Action Icon Size"
        },
        "others": {
          "description": "Icon size in pixels for other UI elements",
          "widget_type": "spinbox",
          "data_type": "integer",
          "validation": {
            "required": true,
            "min": 16,
            "max": 64
          },
          "default": 20,
          "user_friendly_label": "Other Icons Size"
        }
      }
    },
    "export": {
      "style": {
        "format": {
          "description": "Format for exporting layer styles (QGIS QML or SLD)",
          "widget_type": "combobox",
          "data_type": "string",
          "validation": {
            "required": true,
            "allowed_values": ["qml", "sld"]
          },
          "default": "qml",
          "user_friendly_label": "Export Style Format"
        }
      },
      "data": {
        "format": {
          "description": "Format for exporting data (GeoPackage, Shapefile, GeoJSON, KML)",
          "widget_type": "combobox",
          "data_type": "string",
          "validation": {
            "required": true,
            "allowed_values": ["GPKG", "ESRI Shapefile", "GeoJSON", "KML"]
          },
          "default": "GPKG",
          "user_friendly_label": "Export Data Format"
        }
      },
      "layers_enabled": {
        "description": "Enable export of specific layers",
        "widget_type": "checkbox",
        "data_type": "boolean",
        "validation": {
          "required": true
        },
        "default": false,
        "user_friendly_label": "Enable Layer Export"
      },
      "projection_enabled": {
        "description": "Enable reprojection during export",
        "widget_type": "checkbox",
        "data_type": "boolean",
        "validation": {
          "required": true
        },
        "default": false,
        "user_friendly_label": "Enable Reprojection"
      },
      "projection_epsg": {
        "description": "Target EPSG code for reprojection (e.g., 4326 for WGS84)",
        "widget_type": "spinbox",
        "data_type": "integer",
        "validation": {
          "required": false,
          "min": 1000,
          "max": 32767
        },
        "default": 4326,
        "user_friendly_label": "Target EPSG Code"
      }
    },
    "project": {
      "link_legend_layers": {
        "description": "Automatically link legend with layer selection",
        "widget_type": "checkbox",
        "data_type": "boolean",
        "validation": {
          "required": true
        },
        "default": true,
        "user_friendly_label": "Link Legend & Layers"
      },
      "feature_count_limit": {
        "description": "Maximum number of features to display at once (performance limit)",
        "widget_type": "spinbox",
        "data_type": "integer",
        "validation": {
          "required": true,
          "min": 1000,
          "max": 1000000
        },
        "default": 100000,
        "user_friendly_label": "Feature Count Limit"
      },
      "layer_properties_count": {
        "description": "Number of layer properties to display in the interface",
        "widget_type": "spinbox",
        "data_type": "integer",
        "validation": {
          "required": true,
          "min": 1,
          "max": 50
        },
        "default": 10,
        "user_friendly_label": "Layer Properties Count"
      }
    },
    "performance": {
      "use_materialized_views": {
        "description": "Use PostgreSQL materialized views for better performance (PostgreSQL only)",
        "widget_type": "checkbox",
        "data_type": "boolean",
        "validation": {
          "required": true
        },
        "default": true,
        "user_friendly_label": "Use Materialized Views"
      },
      "cache_query_results": {
        "description": "Cache query results to improve response time",
        "widget_type": "checkbox",
        "data_type": "boolean",
        "validation": {
          "required": true
        },
        "default": true,
        "user_friendly_label": "Cache Query Results"
      },
      "max_cache_size_mb": {
        "description": "Maximum cache size in megabytes",
        "widget_type": "spinbox",
        "data_type": "integer",
        "validation": {
          "required": true,
          "min": 10,
          "max": 1000
        },
        "default": 100,
        "user_friendly_label": "Max Cache Size (MB)"
      }
    },
    "optimization_thresholds": {
      "large_dataset_warning": {
        "description": "Feature count above which performance warnings are displayed (0 to disable)",
        "widget_type": "spinbox",
        "data_type": "integer",
        "validation": {
          "required": true,
          "min": 0,
          "max": 1000000
        },
        "default": 50000,
        "user_friendly_label": "Large Dataset Warning Threshold"
      },
      "async_expression_threshold": {
        "description": "Feature count above which expression evaluation runs in background thread",
        "widget_type": "spinbox",
        "data_type": "integer",
        "validation": {
          "required": true,
          "min": 1000,
          "max": 500000
        },
        "default": 10000,
        "user_friendly_label": "Async Expression Threshold"
      },
      "update_extents_threshold": {
        "description": "Feature count below which layer extents are automatically updated after filtering",
        "widget_type": "spinbox",
        "data_type": "integer",
        "validation": {
          "required": true,
          "min": 1000,
          "max": 500000
        },
        "default": 50000,
        "user_friendly_label": "Update Extents Threshold"
      },
      "centroid_optimization_threshold": {
        "description": "Feature count above which centroid optimization is applied for distant layers",
        "widget_type": "spinbox",
        "data_type": "integer",
        "validation": {
          "required": true,
          "min": 1000,
          "max": 100000
        },
        "default": 5000,
        "user_friendly_label": "Centroid Optimization Threshold"
      },
      "exists_subquery_threshold": {
        "description": "WKT length (chars) above which EXISTS subquery mode is used instead of inline WKT",
        "widget_type": "spinbox",
        "data_type": "integer",
        "validation": {
          "required": true,
          "min": 10000,
          "max": 1000000
        },
        "default": 100000,
        "user_friendly_label": "EXISTS Subquery Threshold"
      },
      "parallel_processing_threshold": {
        "description": "Feature count above which parallel processing is enabled",
        "widget_type": "spinbox",
        "data_type": "integer",
        "validation": {
          "required": true,
          "min": 10000,
          "max": 1000000
        },
        "default": 100000,
        "user_friendly_label": "Parallel Processing Threshold"
      },
      "progress_update_batch_size": {
        "description": "Number of features between progress bar updates (higher = faster but less responsive)",
        "widget_type": "spinbox",
        "data_type": "integer",
        "validation": {
          "required": true,
          "min": 10,
          "max": 1000
        },
        "default": 100,
        "user_friendly_label": "Progress Update Batch Size"
      }
    },
    "geometry_simplification": {
      "enabled": {
        "description": "Enable automatic geometry simplification for large WKT expressions (reduces SQL size for better performance)",
        "widget_type": "checkbox",
        "data_type": "boolean",
        "validation": {
          "required": true
        },
        "default": true,
        "user_friendly_label": "Enable Geometry Simplification"
      },
      "max_wkt_length": {
        "description": "Maximum WKT string length in characters before simplification is applied (100000 = 100KB)",
        "widget_type": "spinbox",
        "data_type": "integer",
        "validation": {
          "required": true,
          "min": 10000,
          "max": 1000000
        },
        "default": 100000,
        "user_friendly_label": "Max WKT Length (chars)"
      },
      "preserve_topology": {
        "description": "Preserve geometry topology during simplification (prevents self-intersections but may result in less reduction)",
        "widget_type": "checkbox",
        "data_type": "boolean",
        "validation": {
          "required": true
        },
        "default": true,
        "user_friendly_label": "Preserve Topology"
      },
      "min_tolerance_meters": {
        "description": "Minimum simplification tolerance in meters (higher values = more simplification but less precision)",
        "widget_type": "doublespinbox",
        "data_type": "float",
        "validation": {
          "required": true,
          "min": 0.1,
          "max": 100.0
        },
        "default": 1.0,
        "user_friendly_label": "Min Tolerance (meters)"
      },
      "max_tolerance_meters": {
        "description": "Maximum simplification tolerance in meters (limit to prevent excessive geometry distortion)",
        "widget_type": "doublespinbox",
        "data_type": "float",
        "validation": {
          "required": true,
          "min": 10.0,
          "max": 1000.0
        },
        "default": 100.0,
        "user_friendly_label": "Max Tolerance (meters)"
      },
      "show_simplification_warnings": {
        "description": "Show warning messages when geometry is simplified or when simplification fails",
        "widget_type": "checkbox",
        "data_type": "boolean",
        "validation": {
          "required": true
        },
        "default": true,
        "user_friendly_label": "Show Simplification Warnings"
      }
    }
  }
}
